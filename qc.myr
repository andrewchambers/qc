use std

use "tok"
use "cpp"
use "parse"
use "emit"

const main = {args
	var ts, cmd

	cmd = std.optparse(args, &[
		.argdesc="file.c",
		.minargs=0,
		.maxargs=1,
	])

	if cmd.args.len == 0
		ts = qc.tokinitf(0, "stdin")
	else
		ts = qc.tokinit(cmd.args[0])
	;;
	qc.emit(qc.parse(qc.mkcpp(ts)))
}
